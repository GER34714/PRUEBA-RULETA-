<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>FORTUNA PLAY‚Ñ¢ - RUEDA DE LA FORTUNA (PRUEBA)</title>
<style>
body {
  margin: 0;
  font-family: Arial Black, sans-serif;
  text-align: center;
  color: #0ff;
  background: url('https://iili.io/KfreSig.md.webp') no-repeat center center fixed;
  background-size: cover;
  text-shadow: 0 0 5px #000, 0 0 8px #000;
}
.logo-container { display: flex; justify-content: center; align-items: center; flex-direction: column; margin: 5px 0; width: 100%; }
#logoTop { max-width: 45%; width: 100%; height: auto; display:block; margin: 0 auto 5px auto; }
#finalImage { max-width: 90%; height:auto; display:block; margin: 5px auto 0 auto;}
.textos-superiores { text-align: center; font-size: clamp(1rem,2.5vw,1.3rem); font-weight: bold; line-height: 1.6; margin: 10px 0 15px 0; color: #0ff; text-shadow: 0 0 5px #000,0 0 8px #000; }
#wheelContainer { position: relative; width: 350px; height: 350px; margin:0 auto; border-radius:50%; }
#wheelCanvas { width: 100%; height: 100%; }
#arrow { position:absolute; top:-10px; left:50%; transform:translateX(-50%); width:4px; height:30px; background:#fff; border-radius:2px; z-index:10; }
button { margin:5px 0; padding:12px 30px; font-size:clamp(1rem,2vw,1.2rem); border:none; border-radius:50px; cursor:pointer; transition:.3s; }
#spinButton { background:#ff0; color:#4b0082; font-weight:bold; box-shadow:0 0 10px #000;}
#winnerButton { margin-top:10px; padding:12px 25px; font-size:clamp(1rem,2vw,1.2rem); border-radius:50px; background:#25D366;color:#fff; cursor:pointer; border:none;}
#winnerButton:hover { transform:scale(1.08); }
#winnerPopup { position: fixed; top:50%; left:50%; transform:translate(-50%,-50%) scale(0); background: rgba(0,0,0,0.95); padding: clamp(15px,4vw,25px); border-radius:20px; color:#0ff; font-size:clamp(1rem,3vw,1.4rem); text-align:center; z-index:1000; text-shadow:0 0 5px #000,0 0 8px #000; width:90%; max-width:400px; max-height:80vh; overflow-y:auto; border:3px solid #0ff; box-shadow:0 0 20px #0ff,0 0 40px #0ff,0 0 60px #0ff;}
#winnerPopup.show { transform:translate(-50%,-50%) scale(1);}
#winnerMessage,#winnerDate,#winnerNote,#winnerReturn{margin:5px 0;}
#winnerNote{font-weight:bold;color:#0ff;}
canvas#confetti{position:absolute; top:0; left:0; pointer-events:none; width:100%; height:100%;}
#legal,#rights{font-size:clamp(0.7rem,2vw,0.9rem); margin:2px 0;color:#0ff;text-shadow:0 0 5px #000,0 0 8px #000;}
</style>
</head>
<body>
<div class="logo-container">
  <img id="logoTop" src="https://iili.io/KfLSxhG.md.webp" alt="Logo FORTUNA PLAY">
</div>

<div class="textos-superiores">
  üéÅ GIRA LA RUEDA DE LA FORTUNA Y GANA üéÅ <br>
  üôå INVITA A TUS AMIGOS üôå <br>
  üì∏ RECORD√Å SACARLE CAPTURA A LOS PREMIOS üì∏
</div>

<div id="wheelContainer">
  <canvas id="wheelCanvas" width="350" height="350"></canvas>
  <div id="arrow"></div>
</div>

<button id="spinButton">GIRAR</button>

<div id="winnerPopup">
  <canvas id="confetti"></canvas>
  <div id="winnerMessage"></div>
  <div id="winnerDate"></div>
  <div id="winnerNote">¬°S√ÅCALE CAPTURA A ESTA PANTALLA PARA RECLAMAR TU PREMIO!</div>
  <button id="winnerButton">Solicitar premio</button>
</div>

<div class="logo-container">
  <img id="finalImage" src="https://iili.io/KK0OCrl.md.png" alt="Imagen final">
</div>

<div id="legal">+18 | Juego Responsable | Apuesta con moderaci√≥n</div>
<div id="rights">Todos los derechos reservados FORTUNA PLAY‚Ñ¢</div>

<script>
const canvas=document.getElementById("wheelCanvas");
const ctx=canvas.getContext("2d");
const confettiCanvas=document.getElementById("confetti");
const confettiCtx=confettiCanvas.getContext("2d");

const prizes=["10% extra","15% extra","20% extra","30% extra","1000 fichas","500 fichas","300 fichas"];
const cashiers=[
  {nombre:'Lucas',telefono:'5491171334027'},
  {nombre:'Cami',telefono:'5491156349123'},
  {nombre:'Joaki',telefono:'5491123365501'},
  {nombre:'Facu',telefono:'5491125127839'}
];

// --- PRUEBA: cajero no fijo ---
function getAssignedCashier(){
  const assigned=cashiers[Math.floor(Math.random()*cashiers.length)];
  return assigned;
}

// Dibujar rueda
function drawWheel(rotation=0){
  const numSegments=prizes.length;
  const angle=2*Math.PI/numSegments;
  const colors=["#FFD700","#800080","#9400D3"];
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i=0;i<numSegments;i++){
    ctx.beginPath();
    ctx.moveTo(canvas.width/2,canvas.height/2);
    ctx.arc(canvas.width/2,canvas.height/2,canvas.width/2,i*angle+rotation,(i+1)*angle+rotation);
    ctx.fillStyle=colors[i%colors.length];
    ctx.fill();
    ctx.strokeStyle="#000"; ctx.lineWidth=2; ctx.stroke();
  }
}

// Confeti simple
function startConfetti(){
  const confettis=[];
  for(let i=0;i<150;i++){
    confettis.push({x:Math.random()*confettiCanvas.width,y:Math.random()*confettiCanvas.height,dx:Math.random()*2-1,dy:Math.random()*4+1,color:`hsl(${Math.random()*360},100%,50%)`});
  }
  function animate(){
    confettiCtx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
    confettis.forEach(c=>{
      confettiCtx.fillStyle=c.color;
      confettiCtx.fillRect(c.x,c.y,4,8);
      c.x+=c.dx; c.y+=c.dy;
      if(c.y>confettiCanvas.height)c.y=0;
      if(c.x>confettiCanvas.width)c.x=0;
      if(c.x<0)c.x=confettiCanvas.width;
    });
    requestAnimationFrame(animate);
  }
  animate();
}

// Giro animado
document.getElementById('spinButton').addEventListener('click',()=>{
  const popup=document.getElementById('winnerPopup');
  const winnerMsg=document.getElementById('winnerMessage');
  const winnerDate=document.getElementById('winnerDate');
  const winnerBtn=document.getElementById('winnerButton');
  const cashier=getAssignedCashier();
  const prize=prizes[Math.floor(Math.random()*prizes.length)];
  const duration=4000;
  const start=performance.now();

  function animateWheel(time){
    const elapsed=time-start;
    const t=Math.min(elapsed/duration,1);
    const ease=(1-Math.pow(1-t,3));
    drawWheel(ease*10*Math.PI);
    if(t<1) requestAnimationFrame(animateWheel);
    else showResult();
  }

  function showResult(){
    winnerMsg.textContent=`Ganaste üéâ ${prize} üéâ`;
    const nowStr=new Date().toLocaleString();
    winnerDate.textContent=`Fecha y hora: ${nowStr} | Cajero: ${cashier.nombre}`;
    popup.classList.add('show');
    startConfetti();
    winnerBtn.onclick=()=>{ 
      const msg=encodeURIComponent(`Hola ${cashier.nombre}! üëã\nAcabo de ganar ${prize} üéâ en la RUEDA DE LA FORTUNA el ${nowStr}.\nQuisiera reclamarlo, muchas gracias üôè`);
      window.open(`https://wa.me/${cashier.telefono}?text=${msg}`,'_blank');
    }
  }

  requestAnimationFrame(animateWheel);
});
</script>
</body>
</html>
